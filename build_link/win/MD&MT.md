vs提供四种runtime library的编译选项：/MD、/MDd、/MT、/MTd。其中/MD和/MT的区别是生成**动态库**或者**可执行文件**时，runtime library的集方式：

- /MD，表示运行时库由操作系统提供一个动态库，程序里不集成。
- /MT，表示运行时库由程序集成。

**如果选择/MD**：程序就不需要静态链接运行时库，可以减小软件的大小，所有的动态库模块使用同一个系统提供的运行时库。但是如果机器缺少运行时库则会导致进程加载失败。

**如果选择/MT**：所有动态库会自己连接一份运行时库进去，每个动态库使用自己的运行时库，不会受到运行环境的问题。

对于一个可执行文件，所依赖的所有**动态库**和**静态库**运行时库的编译选项需要一致。不然会出现链接问题。



如果选择使用/MT有一个问题需要特别注意，**堆空间释放问题**。简单来说：

**不同的模块各自有一份C运行时库代码、或者根本没有C运行时库，导致了各个模块会有各自的堆。如果在A堆中申请空间，到B堆中释放就会有崩溃，在模块A申请的空间，必须在模块A中释放。**

该问题主要是关于DLL与进程的地址空间的问题(下面是<<核心编程>>中的一段话):

**单个地址空间是由一个可执行模块和若干个DLL模块组成,这些模块中,有些可以链接到静态版本的C/C++运行期库, 有些可以链接到一个DLL版本的运行期库,而有些模块(如果不是用C/C++编写的话)则根本不需要C/C++运行期库,许多开发人员经常会犯一个常见的错误,因为他们忘记了若干个C/C++运行期库可以存在于单个地址空间中**



> https://www.cnblogs.com/cswuyg/archive/2012/02/03/2336424.html
>
> https://www.cnblogs.com/minggoddess/archive/2010/12/15/1907179.html