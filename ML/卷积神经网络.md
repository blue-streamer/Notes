## 卷积神经网络

最基础的卷积神经网络由两部分组成：卷积层、池化层

### 卷积层

卷积层可以看做是对图像的一个nxn的区域进行卷积操作，卷积模板在图像上滑动。每个卷积操作的结果对应一个下一隐藏层的神经元。图像的像素是卷积输入，卷积输出作为隐藏层的输入。可以认为卷积参数是nxn个像素链接到隐藏层神经元的权重，每个神经元对应一个偏置。如果选择s型激活函数，卷积层的操作如下：
$$
y_{ij} = \sigma(\sum_{k=0}^{n}\sum_{l=0}^{n}w_{kl}a_{i+k,j+l}+b)
$$
其中 y~ij~表示对应i行j列的隐藏层神经元，a~i+k,j+l~是nxn像素中对应的输入。例如一个28x28的图片，经过一个5x5的卷积层，跨度为1即每次移动一个像素。则对应是一个24x24的隐藏层。一个卷积层的权重和偏置是共享的，即一个卷积层可以使用nxn+1个参数来描述。这个比全连接层的参数少了很多。

<img src="卷积神经网络.assets/卷积层.png" alt="卷积层" style="zoom:50%;" />

可以认为一个卷积层输出的是一个图像的特征，在一般的应用中都会有多个卷积层，对应于多个图像特征。

<img src="卷积神经网络.assets/多层卷积层.png" alt="多层卷积层" style="zoom:50%;" />

### 池化层
池化层比较简单，主要作用是简化从卷积层得到的信息。它的操作是从一个nxn的输入中映射出一个输出，来表征这个nxn的区域。常用的操作是**最大值池化**和**L2池化**
- 最大值池化
从nxn的区域中选择最大值
- L2池化
求nxn的输入的平方和的平方根  

下图是一个2x2的池化操作。对于一个24x24的输入，2x2的池化的输出是12x12。

<img src="卷积神经网络.assets/池化层.png" alt="池化层" style="zoom:50%;" />

池化层与卷积层一一对应，可以认为是提出特征的后处理。从直观上来理解，一个特征一旦被发现，它的确切位置不如它相对于其他特征的大概位置重要。这样也有助于减少后面层所需要的参数数目。最终的形态如下：

<img src="卷积神经网络.assets/卷积神经网络.png" alt="卷积神经网络" style="zoom:50%;" />

